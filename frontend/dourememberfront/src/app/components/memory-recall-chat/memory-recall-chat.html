<div class="flex flex-col h-screen bg-gray-50 overflow-hidden">
  <!-- <CHANGE> Added overflow-hidden to parent container -->
  <div class="bg-white border-b border-gray-200 px-6 py-4 shadow-sm flex-shrink-0">
  <!-- <CHANGE> Added flex-shrink-0 to prevent header from shrinking -->
<div class="bg-white border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-1 mb-2">
    <h1 class="text-3xl font-bold text-[#4F7380] font-['Lexend_Deca']">
        Memory Recalls Ground Truth test
    </h1>
    <p class="mt-2 text-gray-600 quicksand-1 text-2xl">
      Lets remember the good moments!
    </p>
</div>
  </div>
</div>

  <div class="flex-1 overflow-y-auto px-4 py-6 space-y-4 min-h-0">
  <!-- <CHANGE> Added min-h-0 to allow flex child to shrink and enable scroll -->
    <div class="flex items-start gap-3 animate-fade-in">
      <div class="flex-shrink-0">
        <div class="w-10 h-10 rounded-full bg-[#F5821F] flex items-center justify-center text-white font-semibold">
          AI
        </div>
      </div>
      <div class="flex-1 max-w-2xl">
        <div class="bg-white rounded-2xl rounded-tl-none shadow-md border border-gray-200 overflow-hidden transition-all duration-300 hover:shadow-lg">
          <div class="relative group">
            <img
              src={{memoryRecall.MemoryRecallUrl}}
              alt="Memory Recall"
              class="w-full h-64 object-cover"
            />
            <div class="absolute top-3 right-3">
              <span class="px-3 py-1 bg-[#F5821F] text-white text-xs font-semibold rounded-full shadow-lg" style="font-family: 'Quicksand', sans-serif;">
                PICTURE
              </span>
            </div>
          </div>
          <div class="p-4">
            <p class="text-[#4F7380] text-base leading-relaxed" style="font-family: 'Nunito Sans', sans-serif;">
              {{ memoryRecall.groundTruthDescriptionComplete }}
            </p>
            <p class="text-xs text-[#9CA3AA] mt-2" style="font-family: 'Nunito Sans', sans-serif;">
              Memory Recall #{{ memoryRecall.MemoryRecallId }}
            </p>
          </div>
        </div>
        <p class="text-xs text-[#9CA3AA] mt-1 ml-3" style="font-family: 'Nunito Sans', sans-serif;">
          Just now
        </p>
      </div>
    </div>

  @for (individualUserMessage of userMessageHistory; track $index) {
    <message-bubble
    [contentOfMessage]="individualUserMessage"
    [indexOfMessage]="$index + 1"
    ></message-bubble>
  }

    <div class="flex items-start gap-3 animate-fade-in" *ngIf="isTyping">
      <div class="flex-shrink-0">
        <div class="w-10 h-10 rounded-full bg-[#F5821F] flex items-center justify-center text-white font-semibold">
          AI
        </div>
      </div>
      <div class="flex-1 max-w-2xl">
        <div class="bg-white rounded-2xl rounded-tl-none shadow-md border border-gray-200 px-5 py-3 inline-block">
          <div class="flex gap-1">
            <div class="w-2 h-2 bg-[#9CA3AA] rounded-full animate-bounce" style="animation-delay: 0ms;"></div>
            <div class="w-2 h-2 bg-[#9CA3AA] rounded-full animate-bounce" style="animation-delay: 150ms;"></div>
            <div class="w-2 h-2 bg-[#9CA3AA] rounded-full animate-bounce" style="animation-delay: 300ms;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="bg-white border-t border-gray-200 px-4 py-4 shadow-lg flex-shrink-0">
  <!-- <CHANGE> Added flex-shrink-0 to prevent footer from shrinking -->
    <div class="max-w-4xl mx-auto">
      <form class="flex items-end gap-3" (submit)="sendMessage(userMessage)" (keydown.enter)="sendMessage(userMessage)">
        <div class="flex-1 relative">
          <textarea
            [(ngModel)]="userMessage"
            name="message"
            rows="1"
            placeholder="Type your response..."
            class="w-full px-4 py-3 pr-12 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-[#4F7380] focus:ring-2 focus:ring-[#4F7380]/20 resize-none transition-all duration-200 text-[#4F7380]"
            style="font-family: 'Nunito Sans', sans-serif; max-height: 120px;"
          ></textarea>
          <div class="absolute bottom-2 right-3 text-xs text-[#9CA3AA]" style="font-family: 'Nunito Sans', sans-serif;">
            {{ userMessage.length }}/500
          </div>
        </div>

        <button
          type="submit"
          [disabled]="!userMessage.trim()"
          class="flex-shrink-0 bg-gradient-to-r from-[#F5821F] to-[#ff9940] text-white px-6 py-3 rounded-2xl font-semibold shadow-md hover:shadow-lg hover:scale-105 active:scale-95 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex items-center gap-2"
          style="font-family: 'Quicksand', sans-serif;"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
          </svg>
          Send
        </button>
      </form>

      <div class="flex gap-2 mt-3">
        <button
          type="button"
          class="px-3 py-1.5 bg-gray-100 text-[#4F7380] text-sm rounded-full hover:bg-gray-200 transition-colors duration-200"
          style="font-family: 'Nunito Sans', sans-serif;"
        >
          I don't remember
        </button>
        <button
          type="button"
          class="px-3 py-1.5 bg-gray-100 text-[#4F7380] text-sm rounded-full hover:bg-gray-200 transition-colors duration-200"
          style="font-family: 'Nunito Sans', sans-serif;"
        >
          Skip this one
        </button>
        <button
          type="button"
          class="px-3 py-1.5 bg-gray-100 text-[#4F7380] text-sm rounded-full hover:bg-gray-200 transition-colors duration-200"
          style="font-family: 'Nunito Sans', sans-serif;"
        >
          Need more time
        </button>
      </div>
    </div>
  </div>
</div>


<style>
@keyframes fade-in {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in {
  animation: fade-in 0.3s ease-out;
}
</style>
